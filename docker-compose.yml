version: "3.9"
services:
	postgres:
		image: postgres:16
		restart: unless-stopped
		environment:
			POSTGRES_USER: appuser
			POSTGRES_PASSWORD: apppass
			POSTGRES_DB: certificates
		ports:
			- "5432:5432"
		volumes:
			- pgdata:/var/lib/postgresql/data

	backend:
		build:
			context: .
			dockerfile: backend/Dockerfile
		restart: unless-stopped
		environment:
			DATABASE_URL: postgresql+psycopg://appuser:apppass@postgres:5432/certificates
			SECRET_KEY: dev-secret-change-me
		depends_on:
			- postgres
		ports:
			- "8000:8000"

volumes:
	pgdata:

